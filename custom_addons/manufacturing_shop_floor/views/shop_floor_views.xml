<!-- shop_floor_views.xml -->
<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Shop Floor Main View - Work Center Selection -->
    <record id="view_shop_floor_work_center_kanban" model="ir.ui.view">
        <field name="name">shop.floor.work.center.kanban</field>
        <field name="model">manufacturing.work.center</field>
        <field name="arch" type="xml">
            <kanban class="o_shop_floor_kanban">
                <field name="name"/>
                <field name="current_work_order_count"/>
                <field name="color"/>
                <templates>
                    <t t-name="kanban-box">
                        <div class="oe_kanban_card oe_kanban_global_click o_shop_floor_work_center" 
                             t-attf-style="border-left: 4px solid #{kanban_color(record.color.raw_value)};">
                            <div class="o_kanban_card_header">
                                <div class="o_kanban_card_header_title">
                                    <div class="o_primary">
                                        <strong><field name="name"/></strong>
                                    </div>
                                </div>
                            </div>
                            <div class="o_kanban_card_content">
                                <div class="row">
                                    <div class="col-6">
                                        <button class="btn btn-primary btn-lg btn-block" 
                                                name="action_open_shop_floor" type="object">
                                            Open Work Center
                                        </button>
                                    </div>
                                    <div class="col-6 text-center">
                                        <div class="o_field_widget">
                                            <span class="o_stat_value">
                                                <field name="current_work_order_count"/>
                                            </span>
                                            <span class="o_stat_text">Active Orders</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <!-- Shop Floor Work Order Interface -->
    <record id="view_shop_floor_work_order_form" model="ir.ui.view">
        <field name="name">shop.floor.work.order.form</field>
        <field name="model">manufacturing.work.order</field>
        <field name="arch" type="xml">
            <form class="o_shop_floor_form" string="Shop Floor - Work Order">
                <header class="o_shop_floor_header">
                    <div class="row">
                        <div class="col-md-8">
                            <h1><field name="display_name" readonly="1"/></h1>
                            <h4><field name="work_center_id" readonly="1"/></h4>
                        </div>
                        <div class="col-md-4 text-right">
                            <field name="state" widget="statusbar" readonly="1"/>
                        </div>
                    </div>
                </header>
                
                <sheet class="o_shop_floor_sheet">
                    <!-- Control Buttons -->
                    <div class="o_shop_floor_controls mb-4">
                        <div class="row">
                            <div class="col-md-3">
                                <button name="action_start" string="▶ START" type="object" 
                                        class="btn btn-success btn-lg btn-block"
                                        invisible="state != 'ready'"/>
                                <button name="action_pause" string="⏸ PAUSE" type="object" 
                                        class="btn btn-warning btn-lg btn-block"
                                        invisible="state != 'progress'"/>
                                <button name="action_resume" string="▶ RESUME" type="object" 
                                        class="btn btn-info btn-lg btn-block"
                                        invisible="state != 'progress'"/>
                            </div>
                            <div class="col-md-3">
                                <button name="action_complete" string="✓ COMPLETE" type="object" 
                                        class="btn btn-primary btn-lg btn-block"
                                        invisible="state not in ['progress', 'ready']"/>
                            </div>
                            <div class="col-md-6">
                                <!-- Operator Selection -->
                                <label string="Current Operator:" for="current_employee_id" class="o_form_label"/>
                                <field name="current_employee_id" class="o_field_widget"
                                       placeholder="Select operator..."/>
                            </div>
                        </div>
                    </div>

                    <!-- Production Information -->
                    <div class="o_shop_floor_info">
                        <div class="row">
                            <div class="col-md-6">
                                <group string="Production Order">
                                    <field name="production_id" readonly="1"/>
                                    <field name="product_id" readonly="1"/>
                                    <field name="date_planned_start" readonly="1"/>
                                    <field name="date_planned_end" readonly="1"/>
                                </group>
                            </div>
                            <div class="col-md-6">
                                <group string="Quantities">
                                    <field name="qty_production" readonly="1"/>
                                    <field name="qty_produced" class="o_field_float"/>
                                    <field name="qty_remaining" readonly="1"/>
                                </group>
                            </div>
                        </div>
                    </div>

                    <!-- Time Tracking -->
                    <div class="o_shop_floor_time">
                        <div class="row">
                            <div class="col-md-6">
                                <group string="Time Information">
                                    <field name="duration_expected" readonly="1"/>
                                    <field name="total_time_spent" readonly="1"/>
                                    <field name="date_start" readonly="1"/>
                                    <field name="date_end" readonly="1"/>
                                </group>
                            </div>
                            <div class="col-md-6">
                                <group string="Quality Control">
                                    <field name="quality_note" placeholder="Quality notes..."/>
                                </group>
                            </div>
                        </div>
                    </div>

                    <!-- Instructions -->
                    <notebook>
                        <page string="Work Instructions">
                            <field name="note" readonly="1"/>
                        </page>
                        <page string="Time Tracking Details">
                            <field name="time_tracking_ids" readonly="1">
                                <list>
                                    <field name="employee_id"/>
                                    <field name="start_time"/>
                                    <field name="end_time"/>
                                    <field name="duration"/>
                                </list>
                            </field>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Shop Floor Work Order List -->
    <record id="view_shop_floor_work_order_list" model="ir.ui.view">
        <field name="name">shop.floor.work.order.list</field>
        <field name="model">manufacturing.work.order</field>
        <field name="arch" type="xml">
            <list class="o_shop_floor_list" create="false" edit="false">
                <field name="sequence" widget="handle"/>
                <field name="name"/>
                <field name="production_id"/>
                <field name="product_id"/>
                <field name="state" decoration-bold="1"/>
                <field name="date_planned_start"/>
                <field name="qty_production"/>
                <field name="qty_produced"/>
                <field name="current_employee_id"/>
                <button name="action_start" string="Start" type="object" 
                        class="btn btn-sm btn-success" invisible="state != 'ready'"/>
                <button name="action_complete" string="Complete" type="object" 
                        class="btn btn-sm btn-primary" invisible="state != 'progress'"/>
            </list>
        </field>
    </record>

    <!-- Shop Floor Actions -->
    <record id="action_shop_floor_work_centers" model="ir.actions.act_window">
        <field name="name">Shop Floor - Work Centers</field>
        <field name="res_model">manufacturing.work.center</field>
        <field name="view_mode">kanban</field>
        <field name="view_id" ref="view_shop_floor_work_center_kanban"/>
        <field name="target">current</field>
    </record>

    <record id="action_shop_floor_work_orders" model="ir.actions.act_window">
        <field name="name">Shop Floor - Work Orders</field>
        <field name="res_model">manufacturing.work.order</field>
        <field name="view_mode">list,form</field>
        <field name="view_ids" eval="[(5, 0, 0),
                                      (0, 0, {'view_mode': 'list', 'view_id': ref('view_shop_floor_work_order_list')}),
                                      (0, 0, {'view_mode': 'form', 'view_id': ref('view_shop_floor_work_order_form')})]"/>
        <field name="domain">[('state', 'in', ['ready', 'progress'])]</field>
        <field name="context">{'search_default_ready': 1}</field>
    </record>
</odoo>